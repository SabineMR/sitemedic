# Plan 27-03: Admin Layout Rebrand

```yaml
phase: 27
plan: "03"
title: "Admin Layout Rebrand"
wave: 2
depends_on: ["27-01"]
files_modified:
  - web/app/admin/layout.tsx
autonomous: true
```

## Objective

Replace all hardcoded blue-600/blue-700 accent colours in the admin sidebar with `var(--org-primary)` CSS custom property. Swap the "SM" brand icon for the org logo (or dynamic initials). Replace "SiteMedic" heading and "Admin Panel" subtitle with org company name and tagline.

## Tasks

<task id="1" name="import-branding-hook">

### Import and use useBranding() hook

In `web/app/admin/layout.tsx`:

**Add import:**
```typescript
import { useBranding } from '@/contexts/branding-context';
```

**Add hook call inside the component (after existing hooks):**
```typescript
const branding = useBranding();
```

</task>

<task id="2" name="rebrand-sidebar-header" depends_on="1">

### Replace brand area — logo/initials + company name + tagline

**Replace the Logo/Brand section (lines 242-252):**

Current:
```tsx
<div className="p-6 border-b border-gray-700/50">
  <Link href="/" className="flex items-center gap-3 group">
    <div className="w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-lg transition-transform duration-200 group-hover:scale-110">
      <span className="text-white font-bold text-xl">SM</span>
    </div>
    <div>
      <h1 className="text-white font-bold text-lg tracking-tight">SiteMedic</h1>
      <p className="text-gray-400 text-xs">Admin Panel</p>
    </div>
  </Link>
</div>
```

New:
```tsx
<div className="p-6 border-b border-gray-700/50">
  <Link href="/" className="flex items-center gap-3 group">
    {branding.logoUrl ? (
      /* eslint-disable-next-line @next/next/no-img-element */
      <img
        src={branding.logoUrl}
        alt={branding.companyName}
        className="max-h-10 w-auto object-contain"
      />
    ) : (
      <div className="w-10 h-10 bg-[color:var(--org-primary)] rounded-xl flex items-center justify-center shadow-lg transition-transform duration-200 group-hover:scale-110">
        <span className="text-white font-bold text-xl">
          {branding.companyName.slice(0, 2).toUpperCase()}
        </span>
      </div>
    )}
    <div>
      <h1 className="text-white font-bold text-lg tracking-tight">{branding.companyName}</h1>
      <p className="text-gray-400 text-xs">{branding.tagline || 'Admin Panel'}</p>
    </div>
  </Link>
</div>
```

**Rules:**
- Only render `<img>` when `branding.logoUrl` is truthy
- Logo: `max-h-10 w-auto object-contain` (40px height)
- Initials fallback: first 2 chars of company name, `bg-[color:var(--org-primary)]`
- Company name fallback already handled by BrandingProvider defaults ("SiteMedic")
- Tagline fallback: "Admin Panel"

</task>

<task id="3" name="rebrand-active-nav" depends_on="1">

### Replace active nav item accent colour

**Replace active nav gradient (line 265):**

Current:
```tsx
? 'bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg shadow-blue-500/20'
```

New:
```tsx
? 'bg-[color:var(--org-primary)] text-white shadow-lg shadow-black/10'
```

Note: `bg-[color:var(--org-primary)]` replaces the gradient with a solid org colour. Shadow changed from `shadow-blue-500/20` to `shadow-black/10` (neutral — can't use CSS var in Tailwind shadow utility).

</task>

<task id="4" name="rebrand-user-avatar" depends_on="1">

### Replace user avatar gradient

**Replace user avatar gradient (line 303):**

Current:
```tsx
<div className="w-8 h-8 bg-gradient-to-br from-blue-600 to-blue-700 rounded-full flex items-center justify-center shadow-lg transition-transform duration-200 group-hover:scale-110">
```

New:
```tsx
<div className="w-8 h-8 bg-[color:var(--org-primary)] rounded-full flex items-center justify-center shadow-lg transition-transform duration-200 group-hover:scale-110">
```

</task>

<task id="5" name="rebrand-loading-spinners" depends_on="1">

### Replace loading spinner border colour

**Replace loading spinner colour in both loading states (lines 105 and 117):**

Current:
```tsx
<div className="w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
```

New:
```tsx
<div className="w-16 h-16 border-4 border-[color:var(--org-primary)] border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
```

Apply this change in both the loading state (line 105) and the platform admin redirect state (line 117).

**Note:** The loading spinner renders BEFORE useBranding() resolves — but the CSS custom property is already injected at root level by BrandingProvider's `<style>` tag (it renders synchronously). So `var(--org-primary)` is available even during loading states.

</task>

<task id="6" name="rebrand-badge-colour" depends_on="1">

### Replace blue badge fallback

**Replace blue badge colour (line 282):**

Current:
```tsx
: 'bg-blue-500 text-white'
```

New:
```tsx
: 'bg-[color:var(--org-primary)] text-white'
```

This is the fallback badge colour for non-red/non-yellow badges.

</task>

## Verification

```yaml
must_haves:
  - "Admin sidebar brand area shows org logo when logoUrl is truthy"
  - "Admin sidebar brand area shows dynamic initials (first 2 chars) when no logo"
  - "Admin sidebar heading shows org company name instead of 'SiteMedic'"
  - "Admin sidebar subtitle shows org tagline or 'Admin Panel' fallback"
  - "Active nav item uses bg-[color:var(--org-primary)] instead of blue-600/700 gradient"
  - "User avatar uses bg-[color:var(--org-primary)] instead of blue-600/700 gradient"
  - "Loading spinners use border-[color:var(--org-primary)] instead of border-blue-600"
  - "No remaining hardcoded blue-600 or blue-700 references in admin layout"
  - "TypeScript compiles without errors (npx tsc --noEmit)"
```
