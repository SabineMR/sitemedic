---
phase: 15-code-quality
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - web/stores/useScheduleBoardStore.ts
  - web/app/admin/schedule-board/page.tsx
autonomous: true

must_haves:
  truths:
    - "Schedule board shows error state with Retry button when API fails (not mock data)"
    - "Schedule board shows empty grid when API returns zero bookings (not mock shifts)"
    - "Schedule board conflict checking still works when conflict-detector edge function is unavailable"
    - "No mock data IDs (mock-medic-1, mock-booking-1, etc.) exist in the codebase"
  artifacts:
    - path: "web/stores/useScheduleBoardStore.ts"
      provides: "Schedule board store without mock data generator"
    - path: "web/app/admin/schedule-board/page.tsx"
      provides: "Schedule board page without mock data banner"
  key_links:
    - from: "web/stores/useScheduleBoardStore.ts"
      to: "web/app/admin/schedule-board/page.tsx"
      via: "error state string (no longer contains 'mock data')"
      pattern: "error.*Failed to load"
---

<objective>
Remove mock data fallback from the schedule board and replace with proper error/empty states.

Purpose: The schedule board currently falls back to fake mock data (7 mock bookings, 3 mock medics) when the Supabase edge function is unavailable. This masks real errors, shows fake booking IDs that don't match real UUIDs, and confuses admins who may think the mock data is real. Replace with proper error state (already exists in the page) and empty state.
Output: ~150 lines of mock data deleted from store, catch block cleaned up, mock data banner removed from page.
</objective>

<execution_context>
@/Users/sabineresoagli/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sabineresoagli/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/15-code-quality/15-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove mock data generator and fix fallback in store</name>
  <files>web/stores/useScheduleBoardStore.ts</files>
  <action>
    Make the following changes to `/web/stores/useScheduleBoardStore.ts`:

    1. **Delete the entire `generateMockScheduleData` function** (lines 174-323). This is the function that creates fake medics (mock-medic-1, mock-medic-2, mock-medic-3) and fake bookings (mock-booking-1 through mock-booking-7). Delete the function and its JSDoc comment.

    2. **Replace the catch block in `fetchScheduleData`** (lines 391-403).

       Current code:
       ```typescript
       catch (error) {
         console.warn('[ScheduleBoard] API unavailable, using mock data for development:', error);
         const mockData = generateMockScheduleData(selectedWeekStart);
         set({
           medics: mockData.medics,
           bookings: mockData.bookings,
           dates: mockData.dates,
           isLoading: false,
           error: 'Using mock data (Supabase not running)',
         });
       }
       ```

       Replace with:
       ```typescript
       catch (error) {
         set({
           medics: [],
           bookings: [],
           isLoading: false,
           error: error instanceof Error ? error.message : 'Failed to load schedule data',
         });
       }
       ```

    3. **Remove console.warn in `checkConflicts` catch block** (line 433).
       Change:
       ```typescript
       catch (error) {
         console.warn('[ScheduleBoard] API unavailable, using basic client-side validation:', error);
         return performBasicConflictCheck(params, get().bookings, get().medics);
       }
       ```
       To:
       ```typescript
       catch {
         return performBasicConflictCheck(params, get().bookings, get().medics);
       }
       ```

       KEEP the `performBasicConflictCheck` function (lines 93-168) -- this is a legitimate simplified conflict checker that runs against real data already in state. Only remove the console.warn.

    4. **Update the JSDoc comment on `fetchScheduleData`** (around line 352).
       Change: "Falls back to mock data if API unavailable (e.g., Docker/Supabase not running)"
       To: "Fetches schedule data from schedule-board-api edge function"
  </action>
  <verify>
    Run: `grep -n "generateMockScheduleData\|mock-medic\|mock-booking\|mock data" web/stores/useScheduleBoardStore.ts` -- must return 0 results.
    Run: `grep -n "console\.warn" web/stores/useScheduleBoardStore.ts` -- must return 0 results.
    Run: `grep -n "performBasicConflictCheck" web/stores/useScheduleBoardStore.ts` -- must return results (function still exists).
  </verify>
  <done>
    generateMockScheduleData function deleted. Fallback catch sets empty arrays + real error message. performBasicConflictCheck retained for legitimate conflict checking. Zero console.warn in store.
  </done>
</task>

<task type="auto">
  <name>Task 2: Remove mock data banner from schedule board page</name>
  <files>web/app/admin/schedule-board/page.tsx</files>
  <action>
    Make the following change to `/web/app/admin/schedule-board/page.tsx`:

    1. **Delete the "Mock Data Info Banner" block** (lines 163-184).
       This is the entire conditional block:
       ```tsx
       {error && error.includes('mock data') && (
         <div className="mb-6 p-4 bg-yellow-500/10 ...">
           ...Using Mock Data (Development Mode)...
         </div>
       )}
       ```
       Delete the entire block (the opening `{error && error.includes('mock data') && (` through the closing `)}` on line 184).

    2. **Simplify the error state condition** (line 187).
       Change:
       ```tsx
       {error && !error.includes('mock data') && (
       ```
       To:
       ```tsx
       {error && (
       ```
       Since there is no more mock data error string, the `!error.includes('mock data')` guard is unnecessary.

    3. **Add an empty state** between the error state and the schedule grid (after line 198, before the Loading State block). Add:
       ```tsx
       {/* Empty State */}
       {!isLoading && !error && medics.length === 0 && (
         <div className="text-center text-gray-400 py-12">
           <div className="text-4xl mb-3">ðŸ“‹</div>
           <div className="text-lg font-medium text-white mb-1">No bookings scheduled</div>
           <div className="text-sm">No medics or bookings found for this week. Try navigating to a different week.</div>
         </div>
       )}
       ```

    4. **Update the ScheduleGrid render condition** (line 209).
       Change:
       ```tsx
       {!isLoading && !error && <ScheduleGrid />}
       ```
       To:
       ```tsx
       {!isLoading && !error && medics.length > 0 && <ScheduleGrid />}
       ```
       This prevents rendering an empty grid when there are no medics.
  </action>
  <verify>
    Run: `grep -n "mock data\|mock Data\|Mock Data" web/app/admin/schedule-board/page.tsx` -- must return 0 results.
    Run: `grep -n "No bookings scheduled" web/app/admin/schedule-board/page.tsx` -- must return 1 result (the new empty state).
    Run: `pnpm build` completes without errors.
  </verify>
  <done>
    Mock data banner removed. Error state simplified. Empty state added for zero-data weeks. ScheduleGrid only renders when medics exist.
  </done>
</task>

</tasks>

<verification>
- `grep -rn "generateMockScheduleData\|mock-medic\|mock-booking" web/stores/` returns empty
- `grep -rn "mock data\|Mock Data" web/app/admin/schedule-board/` returns empty
- `grep -rn "performBasicConflictCheck" web/stores/useScheduleBoardStore.ts` returns results (kept)
- `grep -rn "console\.warn" web/stores/useScheduleBoardStore.ts` returns empty
- Schedule board page renders error state with Retry button when API fails
- Schedule board page renders "No bookings scheduled" when data is empty
- `pnpm build` passes
</verification>

<success_criteria>
1. Schedule board shows proper error state with Retry button when API fails (not mock data)
2. Schedule board shows "No bookings scheduled" empty state when no data (not fake shifts)
3. Schedule board conflict checking still works via performBasicConflictCheck when edge function unavailable
4. Zero mock data IDs remain in the store
5. Build passes
</success_criteria>

<output>
After completion, create `.planning/phases/15-code-quality/15-02-SUMMARY.md`
</output>
