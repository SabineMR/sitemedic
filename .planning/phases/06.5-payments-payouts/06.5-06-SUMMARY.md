---
phase: 06.5-payments-payouts
plan: 06
subsystem: payments
tags: [payouts, revenue-split, platform-fee, calculator, arithmetic-fix]

# Dependency graph
requires:
  - phase: 06.5-payments-payouts
    provides: Payout calculator and Friday payout Edge Function (06.5-02)

provides:
  - Corrected platform fee calculation: 71.4% medic, 28.6% platform (was 60/40)
  - Arithmetic alignment with roadmap: medic £30/hr, client £42/hr
  - Fixed revenue loss from incorrect percentage split

affects: [financial-reporting, medic-payroll, revenue-tracking, admin-operations]

# Tech tracking
tech-stack:
  added: []
  patterns:
    - "71.4/28.6 revenue split matches roadmap pricing (£30 medic / £42 client)"

key-files:
  created: []
  modified:
    - web/lib/payouts/calculator.ts
    - supabase/functions/friday-payout/index.ts

key-decisions:
  - "Fixed platform fee to match roadmap: 71.4% medic (£30/hr), 28.6% platform (£12/hr) from client rate £42/hr"

patterns-established:
  - "Payout validation uses 71.4% medic share within 1 penny tolerance"

# Metrics
duration: 1min
completed: 2026-02-16
---

# Phase 06.5-06: Platform Fee Calculation Fix Summary

**Corrected payout split from 60/40 to roadmap-aligned 71.4/28.6 (medic £30/hr from client £42/hr), fixing revenue loss**

## Performance

- **Duration:** 1 min
- **Started:** 2026-02-16T22:27:53Z
- **Completed:** 2026-02-16T22:29:15Z
- **Tasks:** 1
- **Files modified:** 2

## Accomplishments

- Fixed calculator.ts to use 71.4% medic, 28.6% platform (was 60/40)
- Updated Friday payout Edge Function validation to 71.4%
- Aligned arithmetic with roadmap: medic £30/hr, client £42/hr = 71.4% medic
- Example correction: £336 booking now pays medic £239.90 (was £201.60) - £38.30 more per booking

## Task Commits

Each task was committed atomically:

1. **Task 1: Fix platform fee calculation to 71.4/28.6 split** - `8041fdb` (fix)

## Files Created/Modified

### Modified

- **web/lib/payouts/calculator.ts** - Updated medicPercentage 60 → 71.4, platformPercentage 40 → 28.6, corrected header comments with arithmetic
- **supabase/functions/friday-payout/index.ts** - Changed payout validation from 60% to 71.4% of booking total

## Decisions Made

None - followed plan as specified. This was a gap closure fix to align implementation with existing roadmap specification.

## Deviations from Plan

None - plan executed exactly as written.

## Issues Encountered

None - straightforward percentage arithmetic update with TypeScript compilation verification.

## User Setup Required

None - no external service configuration required.

## Next Phase Readiness

**Ready for:**
- All payout calculations now use correct 71.4/28.6 split
- Historical payouts processed at 60/40 will need manual reconciliation if medics underpaid
- Future payouts will calculate correctly from this commit forward

**Blockers:** None

**Notes:**
- This fixes revenue loss where platform was taking 40% instead of intended 28.6%
- Medics were receiving 60% (£201.60 per £336 booking) instead of 71.4% (£239.90)
- Revenue impact: £38.30 underpayment per 8-hour booking at historical 60/40 rate
- Consider reviewing past payouts for reconciliation if significant volume already processed

---
*Phase: 06.5-payments-payouts*
*Completed: 2026-02-16*
